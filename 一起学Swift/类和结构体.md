---

最使人疲惫的往往不是道路的遥远，而是你心中的郁闷;最使人颓废的往往不是前途的坎坷，而是你自信的丧失;最使人痛苦的往往不是生活的不幸，而是你希望的破灭;最使人绝望的往往不是挫折的打击，而是心灵的死亡

---

# 前言
Swift语言同时支持类和结构体两种数据结构,类是面向对象编程中非常重要的一个概念，而结构体是从C语言中遗留下来的一种组合数据结构。而Swift语言中结构体的功能相对于C语言有了一定的提升，以至于在Swift语言中二者非常相似，常常令人难以取舍，今天我们就来揭示二者异同以及在实际开发中的取舍问题。

# 相同点
在Swift语言中，结构体和类都可以：

* 都可以定义方法，属性
* 都能继承或是实现某个协议
* 都有自己的初始化方法
* 都支持下标访问语法
* 都支持扩展

二者的定义方式是一样的：
<pre>
class A {
    var p1:String?
    var p2:String?
    
    func f() {
      print("这是类的定义")
    }
}

struct A1 {
    var p1:String?
    var p2:String?
    
    func f() {
        print("这是结构体的定义")
    }
}
</pre>

# 不同点
尽管有很多相似的地方，但类和结构体还是有很多不同的地方，下面就让笔者为你一一道来！
* 类支持继承
* 支持deInit()方法（C++语言中叫析构函数）释放资源
* 引用计数器允许对一个类的多次引用

<pre>
class B1 {
    var x:Int?
    var y:Int?
    
    init() {
        print("初始化方法,初始化时调用")
    }
    
    deinit {
        print("反初始化方法，释放资源时调用")
    }
    
    func f() {
        print("B1->f()")
    }
}

class B2 : B1 {
    override func f() {
        print("B2->f()")
    }
}

let b1:B1 = B2()
b1.f()

struct B11 {
    var x:Int?
    var y:Int?
    
    init() {
        print("初始化方法,初始化时调用")
    }
    
    // 没有deInit方法
//    deinit {
//        
//    }
}

// 不支持继承
//struct B12 : B11 {
//
//}
</pre>

除了上面的不同点之外，类和结构体还有几处很重要的不同点：
* 编译器为类自动生成不带参数的初始化方法，而为结构体生成带所有属性的初始化方法
* 结构体实例是值类型，类实例是引用类型

<pre>
// 编译器为二者自动生成初始化函数
class C1 {
    var a:String?
    var b:String?
}

struct C11 {
    var a:String?
    var b:String?
}

let c1:C1 = C1()
c1.a = "a"
let c11:C11 = C11(a: "a", b: "b")

// 类实例是引用类型
// 改变c2实例的值也会改变c1的值
let c2:C1 = c1
print("a=\(c1.a!)")
c2.a = "aaa"
print("a=\(c1.a!)")
// 结构体实例是值类型
// 改变c22的值不会改变c11的值
var c22:C11 = c11
print("a=\(c11.a!)")
c22.a = "aaa"
print("a=\(c11.a!)")
</pre>

下面，我们用一张表格来概括类和结构体的不同：

| 不同点          | 结构体         | 类            |
| :-------------: |:-------------:| :------------:|
|   默认初始化函数   | 带全部参数     | 不带参数        |
|   实例类型        | 值类型         |   引用类型     |
| 继承             | 不支持         |    支持        |
# 如何取舍
通过上面的分析，我们可以知道，结构体在设计上更偏向于数据的封装。而类除了数据的封装之外，还偏向于针对数据的处理。在类和结构体不同点中，最重要的一点是：类实例是引用类型，而结构体实例是值类型，如果是数据的传递过程中，不希望影响原数据的值，请考虑结构体，而如果本身考虑是对同一个实例进行操作的话，则请考虑使用类。还有一个非常重要的点是：结构体不能实现继承，多态等面向对象特性，因此，如果考虑扩展以及面向对象特性的话，也请使用类型。

概括来讲：如果仅仅是针对数据的封装的话，使用结构体即可。而如果考虑运行时特性以及类型的扩展的话请使用类。


